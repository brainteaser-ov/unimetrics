{% extends 'base.html' %}

{% block title %}{{ database.name }}{% endblock %}

{% block content %}
<h1>{{ database.name }}</h1>
<p>Тип базы данных: {{ database.get_db_type_display }}</p>
<a href="{% url 'database:add_data_object' database.pk %}">Добавить объект</a>

<h2>Объекты в базе данных</h2>

<table class="table table-striped">
    <thead>
        <tr>

            <th>Название</th>
            <th>Язык</th>
            <th>Комментарий</th>
            <th>Пол</th>
            <th>Возраст</th>
            <th>Регион</th>
            <th>Дата создания</th>
            <th>Файл</th>
            <th>Аннотация</th>
            <!-- Добавьте другие необходимые поля -->
        </tr>
    </thead>
    <tbody>
    {% for obj in data_objects %}
        <tr>

            <td>{{ obj.name }}</td>
            <td>{{ obj.language }}</td>
            <td>{{ obj.text }}</td>
            <td>{{ obj.get_gender_display }}</td>
            <td>{{ obj.age }}</td>
            <td>{{ obj.region }}</td>
            <td>{{ obj.created_at|date:"d.m.Y H:i" }}</td>
            <td><a href="{{ obj.file.url }}">Скачать</a></td>
            <td><a href="{{ obj.annotation_file.url }}">Скачать</a></td>

            <td>
                <!-- Ссылки на редактирование и удаление -->
                <a href="{% url 'database:edit_data_object' database.pk obj.pk %}">Редактировать</a> |
                <a href="{% url 'database:delete_data_object' database.pk obj.pk %}">Удалить</a>
            </td>

            <!-- Добавьте другие необходимые поля -->
        </tr>
    {% empty %}
        <tr>
            <td colspan="9">В этой базе данных нет объектов.</td>
        </tr>
    {% endfor %}
    </tbody>
</table>

<!-- Элементы управления пагинацией -->
<div class="pagination">
    <span class="page-links">
        {% if data_objects.has_previous %}
            <a href="?page=1">&laquo; Первая</a>
            <a href="?page={{ data_objects.previous_page_number }}">&lsaquo; Предыдущая</a>
        {% endif %}

        <span class="current">
            Страница {{ data_objects.number }} из {{ data_objects.paginator.num_pages }}.
        </span>

        {% if data_objects.has_next %}
            <a href="?page={{ data_objects.next_page_number }}">Следующая &rsaquo;</a>
            <a href="?page={{ data_objects.paginator.num_pages }}">Последняя &raquo;</a>
        {% endif %}
    </span>
</div>


<!-- Отображение сообщений -->
{% if messages %}
  {% for message in messages %}
    <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}

<!-- Формы для запуска анализа -->
<form method="post">
    {% csrf_token %}
    <button type="submit" name="analysis_type" value="vowels">Анализировать гласные</button>
    <button type="submit" name="analysis_type" value="consonants">Анализировать согласные</button>
    <button type="submit" name="analysis_type" value="prosody">Анализировать просодию</button>
</form>

<!-- Отображение результатов анализа -->
<h2>Результаты анализа</h2>
<ul>
    {% for result in processing_results %}
    <li>
        {{ result.data_object.name }} - {{ result.get_analysis_type_display }} -
        <a href="{{ result.result_file.url }}">Скачать результат</a>
    </li>
    {% empty %}
    <li>Нет результатов анализа.</li>
    {% endfor %}
</ul>

{% endblock %}